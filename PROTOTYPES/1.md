## Образец JSON

```json
{
  "id": 1,
  "firstname": "John",
  "lastname": "Doe",
  "email": "johndoe@example.com",
  "birthDate": "1973-01-22",
  "login": {
    "uuid": "1a0eed01-9430-4d68-901f-c0d4c1c3bf22",
    "username": "johndoe",
    "password": "jsonplaceholder.org",
    "md5": "c1328472c5794a25723600f71c1b4586",
    "sha1": "35544a31cc19bd6520af116554873167117f4d94",
    "registered": "2023-01-10T10:03:20.022Z"
  },
  "address": {
    "street": "123 Main Street",
    "suite": "Apt. 4",
    "city": "Anytown",
    "zipcode": "12345-6789",
    "geo": {
      "lat": "42.1234",
      "lng": "-71.2345"
    }
  },
  "phone": "(555) 555-1234",
  "website": "www.johndoe.com",
  "company": {
    "name": "ABC Company",
    "catchPhrase": "Innovative solutions for all your needs",
    "bs": "Marketing"
  }
}
```

## Структура моделей

### User

```ruby
class User < Datory::Model
  attribute :id, type: Integer
  attribute :first_name, from: :firstname, type: String
  attribute :last_name, from: :lastname, type: String
  attribute :email, type: String
  attribute :birth_date, from: :birthDate, type: Date, required: false

  # ...

  attribute :login, type: Hash, prepare: ->(value:) { UserLogin.build!(value) }
  attribute :address, type: Hash, prepare: ->(value:) { UserAddress.build!(value) }

  # ...

  attribute :company, type: Hash, prepare: ->(value:) { UserCompany.build!(value) }
end
```

## Подготовка данных для последующей конвертиции в JSON

Для подготовки данных существует два метода:

- `.build!(hash)` — подготовка данных с вызовом исключения в случае несоответствия описанным в моделях свойствам;
- `.build(hash)` — подготовка данных с игнорированием несоответствий описанным в моделях свойствам.

Примененный метод также применит указанный режим для всех вложенных моделей.

### Подготовка с автоматическим определением моделей

```ruby
hash = User.build!(
  id: SecureRandom.uuid,
  first_name: Faker::Name.first_name,
  last_name: Faker::Name.last_name,
  email: Faker::Internet.email,
  birth_date: Faker::Date.birthday,
  login: {
    uuid: SecureRandom.uuid,
    username: Faker::Internet.username,
    password: Faker::Internet.password,
    md5: Digest::MD5.hexdigest(SecureRandom.uuid),
    sha1: Digest::SHA1.hexdigest(SecureRandom.uuid),
    registered_at: 3.days.ago
  },
  address: {
    street: Faker::Address.street_name,
    suite: Faker::Address.secondary_address,
    city: Faker::Address.city,
    zip_code: Faker::Address.zip_code,
    geo: {
      latitude: Faker::Address.latitude,
      longitude: Faker::Address.longitude
    }
  },
  phone: Faker::PhoneNumber.cell_phone,
  website: Faker::Internet.url,
  company: {
    name: Faker::Company.name,
    catch_phrase: Faker::Company.catch_phrase,
    bs: Faker::Company.bs
  }
)
```

### Подготовка с явным указанием моделей

```ruby
hash = User.build!(
  id: SecureRandom.uuid,
  first_name: Faker::Name.first_name,
  last_name: Faker::Name.last_name,
  email: Faker::Internet.email,
  birth_date: Faker::Date.birthday,
  login: UserLogin.build!(
    uuid: SecureRandom.uuid,
    username: Faker::Internet.username,
    password: Faker::Internet.password,
    md5: Digest::MD5.hexdigest(SecureRandom.uuid),
    sha1: Digest::SHA1.hexdigest(SecureRandom.uuid),
    registered_at: 3.days.ago
  ),
  address: UserAddress.build!(
    street: Faker::Address.street_name,
    suite: Faker::Address.secondary_address,
    city: Faker::Address.city,
    zip_code: Faker::Address.zip_code,
    geo: UserAddressGeo.build!(
      latitude: Faker::Address.latitude,
      longitude: Faker::Address.longitude
    )
  ),
  phone: Faker::PhoneNumber.cell_phone,
  website: Faker::Internet.url,
  company: UserCompany.build!(
    name: Faker::Company.name,
    catch_phrase: Faker::Company.catch_phrase,
    bs: Faker::Company.bs
  )
)
```

### Конвертация в JSON

```ruby
json = hash.to_json
```

## Парс JSON

Для парса JSON существует два метода:

- `.parse!(json)` — парс данных с вызовом исключения в случае несоответствия описанным в моделях свойствам;
- `.parse(json)` — парс данных с игнорированием несоответствий описанным в моделях свойствам.

### Вызов

```ruby
User.parse!(json)
```
